<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Insights - NYC Taxi Data Visualization</title>
  <link rel="stylesheet" href="../css/insight_data.css">
  <style>
    /* Cards for most visited places */
    .places-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }

    .place-card {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .place-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.2);
    }

    .place-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
    }

    .place-info {
      padding: 15px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .place-info span {
      font-size: 0.95rem;
      color: #333;
    }

    .place-info strong {
      color: #007777;
    }

    .place-description {
      font-size: 0.85rem;
      color: #555;
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <header>
    <div class="logo">
      <a href="/" class="home-link">
        <img src="../images/projext_logo101_cstmzd.png" alt="NYC Taxi Analytics Logo" class="logo-img" />
      </a>
    </div>
    <nav>
      <a href="../index.html">Home</a>
      <a href="#">Browse</a>
      <a href="insights.html">Insights</a>
      <a href="data.html">Data</a>
    </nav>
  </header>

  <section class="info-section light">
    <h1>Insights Dashboard</h1>
    <p>Welcome to the insights page! Here you‚Äôll soon find dynamic visualizations that highlight trip patterns, fares, and environmental trends using real NYC taxi data.</p>
    <img src="https://images.unsplash.com/photo-1486308510493-aa64833634ef?auto=format&fit=crop&w=1200&q=80" alt="City analytics">
  </section>

  <section class="info-section dark">
    <h2>Most Visited Places by Trips</h2>
    <canvas id="mostVisitedChart"></canvas>

    <!-- Container for cards -->
    <div class="places-container" id="placesContainer">
      <!-- Place cards injected by JS -->
    </div>
  </section>

  <section class="info-section dark">
    <h2>Coming Features</h2>
    <ul style="text-align:left; max-width:600px; margin:auto;">
      <li>üìä Interactive fare and distance visualizations</li>
      <li>üåÜ Heat maps of pickup and dropoff locations</li>
      <li>üïê Temporal insights (peak hours, busiest days)</li>
      <li>üöó Comparison between ride durations and costs</li>
    </ul>
  </section>

  <footer>
    <div class="footer-container">
      <div class="footer-logo">
        <img src="../images/projext_logo101_cstmzd.png" alt="NYC Taxi Analytics Logo" class="footer-logo-img" />
        <p>NYC Taxi Analytics ‚Äî Empowering smarter urban mobility decisions.</p>
      </div>
      <div class="footer-links">
        <h3>Explore</h3>
        <a href="../index.html">Home</a>
        <a href="#">Browse</a>
        <a href="insights.html">Insights</a>
        <a href="data.html">Data</a>
      </div>
      <div class="footer-socials">
        <h3>Follow Us</h3>
        <a href="#"><i class="fab fa-twitter"></i> Twitter</a>
        <a href="#"><i class="fab fa-linkedin"></i> LinkedIn</a>
        <a href="#"><i class="fab fa-facebook"></i> Facebook</a>
        <a href="#"><i class="fab fa-instagram"></i> Instagram</a>
      </div>
    </div>
    <p class="footer-bottom">¬© 2025 NYC Metropolis Taxi Analytics | Inspired by WRI.org</p>
  </footer>

  <button id="scrollTopBtn"><i class="fas fa-arrow-up"></i></button>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const API_BASE = "http://127.0.0.1:8000/api";

    // Curated images for each zone
    const zoneImages = {
      "Upper West Side South": "https://images.unsplash.com/photo-1580674220523-5bf2cadb5ffc?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8VXBwZXIlMjBXZXN0JTIwU2lkZSUyMFNvdXRofGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500",
      "Van Cortlandt Park": "https://images.unsplash.com/photo-1730765458504-500388bdf2ec?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8VmFuJTIwQ29ydGxhbmR0JTIwUGFya3xlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500",
      "Midtown South": "https://images.unsplash.com/photo-1731094114672-f6f446490ebb?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8TWlkdG93biUyMFNvdXRofGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500",
      "UN/Turtle Bay South": "https://images.unsplash.com/photo-1699025101096-b5038eda3086?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8OHx8bWFuaGF0YW58ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500",
      "Long Island City/Hunters Point": "https://images.unsplash.com/photo-1595544600111-a9a3247c35d4?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fExvbmclMjBJc2xhbmQlMjBDaXR5JTJGSHVudGVycyUyMFBvaW50fGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500",
      "Van Nest/Morris Park": "https://images.unsplash.com/photo-1684061335022-a61e01a5bae7?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8VmFuJTIwTmVzdCUyRk1vcnJpcyUyMFBhcmt8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500",
      "North Corona": "https://images.unsplash.com/photo-1587408215029-f28551884421?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTF8fE5vcnRoJTIwQ29yb25hfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500",
      "Little Italy/NoLiTa": "https://images.unsplash.com/photo-1759054712155-46f373d1f573?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8TGl0dGxlJTIwSXRhbHklMkZOb0xpVGF8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&q=60&w=500",
      "Midwood": "https://plus.unsplash.com/premium_photo-1698501025704-e0d77655cdaf?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8TWlkd29vZHxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&q=60&w=500",
      "Morningside Heights": "https://plus.unsplash.com/premium_photo-1664266386277-2789b93c8b53?ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8TW9ybmluZ3NpZGUlMjBIZWlnaHRzfGVufDB8fDB8fHww&auto=format&fit=crop&q=60&w=500"
    };

    function getPlaceDescription(zone) {
      const descriptions = {
        "Upper West Side South": "Popular for its cultural attractions, cafes, and Riverside Park.",
        "Van Cortlandt Park": "Known for its vast parkland, jogging paths, and historic sites.",
        "Midtown South": "A bustling commercial area with theaters, restaurants, and nightlife.",
        "UN/Turtle Bay South": "Home to the UN Headquarters and a mix of residential and office spaces.",
        "Long Island City/Hunters Point": "Trendy area with waterfront parks, galleries, and dining.",
        "Van Nest/Morris Park": "Residential neighborhood with local shops and community parks.",
        "North Corona": "A vibrant area with cultural diversity and food hotspots.",
        "Little Italy/NoLiTa": "Famous for Italian restaurants, street festivals, and historic charm.",
        "Midwood": "Quiet residential streets with historic homes and local businesses.",
        "Morningside Heights": "Academic hub with Columbia University and beautiful parks."
      };
      return descriptions[zone] || "A popular NYC destination.";
    }

    async function renderMostVisitedChart() {
      try {
        const response = await fetch(`${API_BASE}/visit/most_trips`);
        const data = await response.json();

        // Chart
        const labels = data.map(item => item.Zone);
        const values = data.map(item => item.NumTrips);
        const ctx = document.getElementById("mostVisitedChart").getContext("2d");

        new Chart(ctx, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [{
              label: "Number of Trips",
              data: values,
              backgroundColor: labels.map(() => `rgba(${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, ${Math.floor(Math.random()*255)}, 0.7)`)
            }]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: true },
              title: { display: true, text: "Most Visited NYC Zones by Trips" }
            },
            scales: { y: { beginAtZero: true } }
          }
        });

        // Cards
        const container = document.getElementById('placesContainer');

        data.forEach(item => {
          const card = document.createElement('div');
          card.className = 'place-card';

          const img = document.createElement('img');
          img.src = zoneImages[item.Zone] || `https://source.unsplash.com/400x180/?${encodeURIComponent(item.Zone)},NYC`;
          img.alt = item.Zone;
          card.appendChild(img);

          const infoDiv = document.createElement('div');
          infoDiv.className = 'place-info';
          infoDiv.innerHTML = `
            <span><strong>Zone:</strong> ${item.Zone}</span>
            <span><strong>Neighborhood:</strong> ${item.DOLocationName}</span>
            <span><strong>Number of Trips:</strong> ${item.NumTrips.toLocaleString()}</span>
            <div class="place-description">
              ${getPlaceDescription(item.Zone)}
            </div>
          `;
          card.appendChild(infoDiv);
          container.appendChild(card);
        });

      } catch (error) {
        console.error("Error rendering chart and cards:", error);
      }
    }

    document.addEventListener("DOMContentLoaded", renderMostVisitedChart);
  </script>

</body>
</html>
